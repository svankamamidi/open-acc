<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="manifest" href="manifest.json" />
<link rel="stylesheet" href="//code.jquery.com/ui/1.13.0/themes/base/jquery-ui.css">
<style>
  .prevent-select {
    -webkit-user-select: none; /* Safari */
    -ms-user-select: none; /* IE 10 and IE 11 */
    user-select: none; /* Standard syntax */
    overflow-x: hidden;
  }
	
  /* Create two equal columns that floats next to each other */
  .top-left-column {
    flex: 75%;
    height: 5%;
  }
  
  .top-right-column {
    flex: 20%;
    height: 5%;
  }
  .admin-settings {    
    padding-top: 5%
  }
  .top-row {
    display: flex;
  }
  
  .addInteractionDiv {
	width: 15%
  }
  
  .backButtonDiv {
    width: 15%;
    font-size: larger
  }
  
  .interactionTypes a {
    color: #2196f3
  }
  
  .textArea {
	width: 100%;
	font-size: larger;
  }
  .keyboardIcon {
	width: 8%;
	padding-right: 2%;
	padding-top: 2%;
  }
  
  .topTextArea {
	padding-bottom: 2%;
	display: flex;
	//justify-content: space-between;
  }
  
  .ul-container {
   	margin:0 auto;
   	//background:yellow;
   	text-align:center;
   	overflow:auto;
   	min-width:201px;
   	max-width:901px;
   	display:block;
   	list-style:none;
  }

  .leaf-item {
    font-weight:bold;
   	background-color:#FDF2E9;
   	border:2px solid #FDF2E9;
   	box-sizing:border-box;
   	float:left;
   	height:100px;
   	width:100px;
   	margin:5px 3px;
  }
  
  .folder-item {
    font-weight:bold;
   	background-color:#FDF2E9;
   	border:1px solid #F0F3F4;
   	box-sizing:border-box;
   	float:left;
   	height:100px;
   	width:100px;
   	margin:5px 3px;
	background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACACAMAAAD04JH5AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAA6lBMVEUAAAD/uQD/uQD/uQD/uQD/uQD/uQD/uwD/uQD/uQD/uQD/uQD/ugD/uQD/ugD/1lr/0En/yjL/1ln/xzP/0En/11zominomij/uQD/01n/55//33//11//01r/56D/34D/12D/6KD/4IH/2GH/1Fr/1Vz/6KH/2GL/vRD/23T/vhL/xi7/1WH/5Zn/553/3Xf/5pr/4IX/2Wj/2GP/3nj/3XP/22z/2WP/2WT/2WX/2Wb/2Wf/2mn/2mj/2mr/22n/22r/2Wr/2Wn/2mv/22v/2mf/2mb/2GT/2GDzukfzuUbafRfaexb////eYXQTAAAAGHRSTlMAHazy6sR1D+3sWP59gIj+5kj+N+P+8vExUlyIAAAAAWJLR0RNgGggZQAAAAd0SU1FB+QDDQshOSsEIzMAAAFLSURBVHja7drZVsIwFIVhBOdZnOKAINXWeQAVZ1GcEN//eeCGq3PTNmGfc7G/F8i/krYryWqhQERERERENDRWLLk0xicmp0Yy/rRLbWZ2BAFFl8HcfPiAkstkIXiAy2hROyB4gdMucNoFOQK2tnd2c1laXgkRkHv8gfKqf0Blr1rLb807oLJfjzys+wYc+I0fRZ4Bh3E98eMVcHQcVxO1gJPTs/OLyyR4QJze1XWj6U0E3KR1e9cKQQTcg4mABzB7AY9gDLAX8AQmAhpgnAER8AwmAl7A7M0AA17BRMAbmAhog9l7Bt7BRMAHmL0ZUH8NGdAB4xKIgE8wLoG9APVPMfeEDFDfkKgfTtUD1A+nX2D2AtSvaHhP+A1m77b8B4wBIqAFZi+gCSYCEjB7Ab9gIqAGZm8Gun9QXRGw0fsH6m3y/0kiIiIiIhrqAxvdHvTMOppkAAAAJXRFWHRkYXRlOmNyZWF0ZQAyMDIwLTAzLTEzVDExOjMzOjU3KzAwOjAwvq9K8QAAACV0RVh0ZGF0ZTptb2RpZnkAMjAyMC0wMy0xM1QxMTozMzo1NyswMDowMM/y8k0AAAAASUVORK5CYII=')
  }
  
  table {
    font-family: arial, sans-serif;
    font-size: 100%;
    font-weight: bold;
    border-spacing: 15px 8px;
    border-collapse: separate;
    border: 1px solid white;
    width: 100%;
  }

  td, th {
    border: 1px solid #F0F3F4;
    text-align: center;
    padding: 12px;
    background-color: #FDF2E9;
    border-radius: 4px;
  }
  
  td {
	height: 15vw;
    width: 15vw;
  }

  //tr:nth-child(even) {
    //background-color: #dddddd;
  //}

.breadcrumb-navigation {
    padding-bottom: 1%;
    //background-color: rgb(238, 238, 238);
}

.breadcrumb-navigation>li {
    display: inline;
}

.breadcrumb-navigation>li>a {
    color: #026ece;
    text-decoration: none;
}

.breadcrumb-navigation>li>a:hover {
    color: #6fc302;
    //text-decoration: underline;
}

.breadcrumb-navigation li+li:before {
    padding: 4px;
    @charset "UTF-8";
    content: "\2192";
}
</style>
<script src="https://code.jquery.com/jquery-3.6.0.js"></script>
<script src="https://code.jquery.com/ui/1.13.0/jquery-ui.js"></script>
<script>
  // Registering Service Worker
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('/open-aac/sw.js');
  }	
  $( function() {
	var name = $("#name");
	var addMessageOrFolderDialog = $("#addMessageOrFolderDialog").dialog({
      autoOpen: false,
      height: 600,
      width: 400,
      modal: true,
      buttons: {
        "Save": saveInteraction,
        Cancel: function() {
	  document.querySelector('#uploadItemPhoto').value = '';
	  var image = document.getElementById('itemPhoto');
	  image.style.visibility = 'hidden';
          addMessageOrFolderDialog.dialog( "close" );
        }
      },
      close: function() {
	document.querySelector('#uploadItemPhoto').value = '';
	var image = document.getElementById('itemPhoto');
	image.style.visibility = 'hidden';
	if (globalSettings.currentAction === 'edit'){
	  addMessageOrFolderDialog.dialog( "close" );	  
	}else{
	  onAddMsgFoldrDlgClose();
	}
      }
    });
    addMessageOrFolderDialog.keypress(function(e) {
      if( e.keyCode == $.ui.keyCode.ENTER ) {
        $("#addMessageOrFolderDialog").parent().find('.ui-dialog-buttonpane button:first').click();
        return false;
      }
    });
    // Event listener for clicking outside the menu
    $(document).on("click", function(event) {      
      if (!$(event.target).closest("#item-edit-menu, #ul-level-1").length) {
        $("#item-edit-menu").hide();
      }
    });

    var importConfigDialog = $("#importConfigDialog").dialog({
      autoOpen: false,
      height: 400,
      width: 350,
      modal: true,
      buttons: {
        "Import": importConfig,
        Cancel: function() {	  
          importConfigDialog.dialog( "close" );
        }
      },
      /*close: function() {		
      }*/
    });
    importConfigDialog.keypress(function(e) {
      if( e.keyCode == $.ui.keyCode.ENTER ) {
        $("#importConfigDialog").parent().find('.ui-dialog-buttonpane button:first').click();
        return false;
      }
    });
    
    //Can per page load actions
    //load saved levels & tiles
    var localStorage = window.localStorage;
    var levelItems = localStorage.getItem("ul-level-1")
    if(!levelItems){ //if no custom folder structure defined load default one
      var configJson = loadFile("aac-config.json");
      localStorage.setItem("ul-level-1", configJson);
    }    
    loadSavedLevelsFromCache();
  });
  
    class TreeNode {
  constructor(key, value = key, parent = null) {
    this.key = key;
    this.value = value;
    this.parent = parent;
    this.children = [];
  }

  get isLeaf() {
    return this.children.length === 0;
  }

  get hasChildren() {
    return !this.isLeaf;
  }
}

class Tree {
  constructor(key, value = key) {
    this.root = new TreeNode(key, value);
  }

  *preOrderTraversal(node = this.root) {
    yield node;
    if (node.children.length) {
      for (let child of node.children) {
        yield* this.preOrderTraversal(child);
      }
    }
  }

  *postOrderTraversal(node = this.root) {
    if (node.children.length) {
      for (let child of node.children) {
        yield* this.postOrderTraversal(child);
      }
    }
    yield node;
  }

  update(key, updatedNode){
    var currentNode = tree.find(key);
    currentNode.key = updatedNode.name;
    currentNode.value.name = updatedNode.name;
    currentNode.value.image = updatedNode.image;
  }
	
  insert(parentNodeKey, key, value = key) {
    for (let node of this.preOrderTraversal()) {
      if (node.key === parentNodeKey) {
        node.children.push(new TreeNode(key, value, node));
        return true;
      }
    }
    return false;
  }

  remove(key) {
    for (let node of this.preOrderTraversal()) {
      const filtered = node.children.filter(c => c.key !== key);
      if (filtered.length !== node.children.length) {
        node.children = filtered;
        return true;
      }
    }
    return false;
  }

  find(key) {
    for (let node of this.preOrderTraversal()) {
      if (node.key === key) return node;
    }
    return undefined;
  }
}
  
  let globalSettings = new Settings();
  let tree = new Tree(1, 'root');
  let mainMenuMap = new Map();
  let ROOT = {};
  ROOT.name = 'root';
  
  function renderTextItem(item){		
    var ul = document.getElementById("ul-level-1");
    var li = createItemLi();
	li.classList.add("leaf-item");
    var liElement = document.createTextNode(item);
    if (item.image && item.image !== "No picture"){
      liElement.style.backgroundImage = "url(item.image)"
    }
    li.appendChild(liElement);
    ul.appendChild(li);
  }
  
  function renderItems(item){	
    switch(typeof(item)){
      case 'object':
		renderItem(item);
        break;
      case 'string':
        renderTextItem(item)
        break;
	}
  }
  
  function renderItem(item){
    var ul = document.getElementById("ul-level-1");
    var li = createItemLi(item);
    var liElement = document.createTextNode(item.name);
    if (item.image && item.image !== "No picture"){
      li.style.backgroundImage = 'url(' + item.image + ')';
      li.style.backgroundSize = '100% 85%'; //'cover';
      li.style.backgroundRepeat = 'no-repeat';
      li.style.backgroundPosition = 'center bottom'; //'center center';    
    }
    li.appendChild(liElement);	  
    ul.appendChild(li);
	if (item.type && item.type==='folder'){
		li.classList.add("folder-item");
	}else{
		li.classList.add("leaf-item");
	}
  }
  
  function loadGivenLevel(levelItems){

    levelItems && Array.isArray(levelItems) && levelItems.forEach(item => {

      mainMenuMap.set(item.value.name, item.value);

	  renderItems(item.value);

    });

  }
	
  function loadFile(filePath) {
    var result = null;
    var xmlhttp = new XMLHttpRequest();
    xmlhttp.open("GET", filePath, false);
    xmlhttp.send();
    if (xmlhttp.status==200) {
      result = xmlhttp.responseText;
    }
    return result;
  }
	
  function loadSavedLevelsFromCache(){
    var localStorage = window.localStorage;
    tree = new Tree(1, 'root');
    var levelItems = localStorage.getItem("ul-level-1") && JSON.parse(localStorage.getItem("ul-level-1"));
    levelItems && Array.isArray(levelItems) && levelItems.forEach(item => {
      tree.insert(1, item.name + "1", item);
      traverseStoredTreeAndCreateNodes(item, ROOT, 1);
      mainMenuMap.set(item.name, item);
      renderItems(item);
    });
	globalSettings.currentLevel = 1;
  }

  function traverseStoredTreeAndCreateNodes(startNode, parentNode, level){
    var localLevel = level+1;
    startNode.value && startNode.value.forEach(item => {
      if (item.type === 'message'){
        tree.insert(startNode.name + level, item.name + localLevel, item);	
      }else if (item.type === 'folder'){
	tree.insert(startNode.name + level, item.name + localLevel, item);
	traverseStoredTreeAndCreateNodes(item, startNode, localLevel);
      }
    })
  }
  
  function createItemLi(item){
    var li = document.createElement("li");
    li.setAttribute("id", "li" + item.name);
    li.addEventListener('click', function(event) {
      handleItemClick(li, item, event);
    });
    return li;
  }
  
  function handleItemClick(liElement, item, event){
	//Reset previous clicks on Settings
	globalSettings.settingsClickCount = 0;
	if(item.type && item.type == 'folder'){
		/*if (globalSettings.currentItem && globalSettings.currentItem.type === 'folder'){
			globalSettings.parentItem = globalSettings.currentItem ? globalSettings.currentItem : item.parent;
		}else{
			globalSettings.parentItem = globalSettings.currentFolder;
		}*/
		globalSettings.parentItem = item;
		globalSettings.currentFolder = globalSettings.parentItem;
	}else{
		if (!globalSettings.parentItem){
			globalSettings.parentItem = 'root';
		}
		if (globalSettings.currentItem && globalSettings.currentItem.type === 'folder' && globalSettings.currentItem.parent === globalSettings.parentItem){
			globalSettings.parentItem = globalSettings.currentItem;
		}
		globalSettings.currentFolder = globalSettings.parentItem;		
	}
	globalSettings.currentItem = item;
    if (globalSettings && globalSettings.adminMode){
      handleItemEdit(liElement, event);
    }else{
      promptItem(liElement.innerText);
	  if (item.type && item.type === 'folder'){
		displayFolderMenu(item);
		globalSettings.currentLevel = globalSettings.currentLevel + 1;
	  }else{
		var spaceChar;
		if (document.getElementById("textareaEle").value){
		  spaceChar = " ";
		}else{
		  spaceChar = "";
		}
		document.getElementById("textareaEle").value = document.getElementById("textareaEle").value + spaceChar + liElement.innerText;
	  }
    }
  }

  function downloadFile(content, fileName, mimeType){
    const link = document.createElement("a");
    //const content = document.querySelector("textarea").value;
    const file = new Blob([content], { type: /*'text/plain'*/mimeType });
    link.href = URL.createObjectURL(file);
    link.download = fileName;
    link.click();
    URL.revokeObjectURL(link.href);
  }
  
  function exportConfig(){
    var localStorage = window.localStorage;
    var configJsonStr = localStorage.getItem("ul-level-1");
    downloadFile(configJsonStr, 'aac-config.json', 'application/json');
  }

  function readTextFile(fileElementSelector){      
    return new Promise((resolve, reject) => {
      const reader = new FileReader();
      reader.readAsText(document.querySelector(fileElementSelector).files[0]);
      reader.onload = () => resolve(reader.result);
      reader.onerror = error => reject(error);
    });
  }
	
  function importConfig(){
    readTextFile("#importConfigFile").then(configJson => {
      var localStorage = window.localStorage;
      localStorage.setItem("ul-level-1", configJson);
      $("#importConfigDialog").dialog("close");
    });    
  }	  

  function importDialog(){
    $("#importConfigDialog").dialog("open");
  }
  
  function displayFolderMenu(item){
	//remove all li elements of ul and render new ones
	//	new li elements have to be looked up in map for item.value	
	$('#ul-level-1 li').each(function(){
      $(this)[0].remove();
    });
    document.getElementById("backButtonDiv").style.display="block";	
	item && item.value && item.value.forEach(childItem => {
      renderItems(childItem);
	  if (!tree.find(childItem.name + (globalSettings.currentLevel + 1))){
		tree.insert(item.name, childItem.name + (globalSettings.currentLevel + 1), childItem);
	  }
    });	
    updateBreadCrumbs(item);
  }

  /* recursively builds the folder hierarchy path */
  function buildBreadCrumbPath(folderItem, level){
    var breadCrumbs = [];
    if (level <= 1){
      return breadCrumbs;
    }else if (level > 1){
      breadCrumbs.push(folderItem.name);
      var parent = tree.find(folderItem.name + (level-1));
      if (parent && parent.parent){
        breadCrumbs.concat(buildBreadCrumbPath(parent.parent.value, level-2));
      }
    }
    return breadCrumbs;
  }
	
  function updateBreadCrumbs(folderItem){
	var ul = document.getElementById("ul-bread-crumbs");
	var breadCrumbs = [];
	breadCrumbs = buildBreadCrumbPath(folderItem, globalSettings.currentLevel + 1);
	for(let i = 0; i < breadCrumbs.length; i++){
      	  var li = document.createElement("li");
	  var liElement = document.createTextNode(breadCrumbs[i]);
	  li.appendChild(liElement);
	  ul.appendChild(li);
    	}	
  }
	
  function onBackButtonClick(){
    if (globalSettings && globalSettings.currentLevel == 2){
      document.getElementById("backButtonDiv").style.display="none";
    }
    $('#ul-level-1 li').each(function(){
      $(this)[0].remove();
    });

    $('#ul-bread-crumbs li').each(function(){
      $(this)[0].remove();
    });	  

    globalSettings.currentLevel = globalSettings.currentLevel ? globalSettings.currentLevel - 1 : 1;
    if (globalSettings.parentItem){
      globalSettings.currentItem = globalSettings.parentItem.parent;//TODO: have to get object, here globalSettings.parentItem.parent is just string
      globalSettings.parentItem = globalSettings.currentItem.parent;
    }else{	  
      globalSettings.currentItem = globalSettings.currentItem.parent;
      globalSettings.parentItem = 'root';
    }    
    if (globalSettings.currentItem === 'root'){
      loadSavedLevelsFromCache();
    }else{
      var item = globalSettings.currentItem;
      item && item.value && item.value.forEach(childItem => {
        renderItems(childItem);
        if (!tree.find(childItem.name + (globalSettings.currentLevel + 1))){
	  tree.insert(item.name, childItem.name + (globalSettings.currentLevel + 1), childItem);
        }
      });
      updateBreadCrumbs(globalSettings.currentItem);
    }    
    //var lookUpKey = 1;
    /*if (globalSettings.parentItem && globalSettings.parentItem.parent && 
			globalSettings.parentItem.parent != 'root'){
		lookUpKey = globalSettings.parentItem.name + globalSettings.currentLevel;
	}
	loadGivenLevel(tree.find(lookUpKey).children);*/
  }
  
  function promptItem(words){
    try{
    	var synth = window.speechSynthesis;
    	synth.speak(new SpeechSynthesisUtterance(words));
    }catch(e){
      console.log(e);
    }
  }
  
  function handleItemEdit(liElement, event){
    if (globalSettings) {
      globalSettings.currentItemLiEle = liElement;
    }    
    
    $("#item-edit-menu").menu().hide();
    var menu = document.getElementById('item-edit-menu');
    menu.style.position = "absolute";
    menu.style.left = event.x + 'px';
    menu.style.top = event.y + 'px';
    $("#item-edit-menu").show();
    //.position({my: "left top", at: "right bottom", of: liElement})    
  }
  
  function editItemContents(){
    $("#item-edit-menu").menu().hide();
    //document.getElementById("item-edit-menu").style.display="none";
    $("#name").val(globalSettings.currentItem.name);
    $("#addMessageOrFolderDialog").dialog("open");	  
    globalSettings.currentAction = "edit";
  }
  
  function deleteItem(){
    $("#item-edit-menu").menu().hide();	  
    //document.getElementById("item-edit-menu").style.display="none";
    tree.remove(globalSettings.currentItem.name + globalSettings.currentLevel);
	/*
	if (globalSettings.parentItem && globalSettings.parentItem.type == 'folder' && 
		globalSettings.currentItem && globalSettings.currentItem.name != globalSettings.parentItem.name){
		globalSettings.parentItem.value.forEach((eachItem, index) => {
			if (eachItem.name == globalSettings.currentItem.name){
				globalSettings.parentItem.value.splice(index, 1);
			}
		});
		mainMenuMap.set(globalSettings.parentItem.name, globalSettings.parentItem);
	}else{
		mainMenuMap.delete(globalSettings.currentItem.name);
	}*/
	$(globalSettings.currentItemLiEle).remove();
	//saveFromMap();
	saveFromTree();  
  }
	
  function fetchPicBase64(imageTagId){
  	if (document.getElementById(imageTagId) && document.getElementById(imageTagId).src && document.getElementById(imageTagId).src.includes("base64")){
	  return Promise.resolve(document.getElementById(imageTagId).src);
	}
	var picUploadPromise;
	document.querySelector('#uploadItemPhoto').files && Array.from(document.querySelector('#uploadItemPhoto').files).forEach(pictureFile => {
          picUploadPromise = toBase64(pictureFile).then(base64VoiceFile => {
            return base64VoiceFile;
            console.log(base64VoiceFile);
	    document.querySelector('#uploadItemPhoto').value = '';
          });      
        });
	if (!picUploadPromise){
	  picUploadPromise = Promise.resolve("No picture");
	}
	return picUploadPromise;
  }
	
  function saveInteraction(){	    
	var newItem = {};
	newItem.name = $("#name").val();
	newItem.type = globalSettings.lastAction == InteractionType.Folder ? 'folder' : 'message';
	  
	newItem.parent = globalSettings.parentItem && globalSettings.parentItem.name ? globalSettings.parentItem.name : 'root';	
	return fetchPicBase64('itemPhoto').then((picBase64) => {
	  newItem.image = picBase64;	  
	  var parentLevel = globalSettings.currentLevel - 1;
	  var parentForTree;
	  if (globalSettings.currentItem && globalSettings.currentItem.type !== 'message'){
		  parentForTree = globalSettings.currentItem.name + parentLevel;
	  }
	  else if(!globalSettings.currentFolder || !globalSettings.currentFolder.name || globalSettings.currentFolder.name === 'root'){
		  parentForTree = 1;
	  }else{
		  parentForTree = globalSettings.currentFolder.name + parentLevel;
	  }
	  if(globalSettings.currentAction === 'edit'){	    
	    var oldName = globalSettings.currentItem.name;
	    tree.update(globalSettings.currentItem.name + globalSettings.currentLevel, newItem);
	    //after above statement globalSettings.currentItem is updated and its name field contains new name!!
	    updateItemUI(oldName, newItem);
	  }else{
	    tree.insert(parentForTree, newItem.name + globalSettings.currentLevel, newItem);
	    renderItem(newItem);
	  }
	  //saveFromMap();
	  saveFromTree();	  
	  document.querySelector('#uploadItemPhoto').value = '';
	  var image = document.getElementById('itemPhoto');
	  image.style.visibility = "hidden";
          $("#addMessageOrFolderDialog").dialog("close");
	});
  }

  function updateItemUI(oldName, newItem){
    var uiElement = document.querySelector("#li" + oldName);
    uiElement.innerText = newItem.name;
    if (newItem.image && newItem.image !== "No picture"){
      uiElement.style.backgroundImage = 'url(' + newItem.image + ')';
      uiElement.style.backgroundSize = '100% 85%'; //'cover';
      uiElement.style.backgroundRepeat = 'no-repeat';
      uiElement.style.backgroundPosition = 'center bottom'; //'center center';    
    }
  }
	
  function saveFromTree(){
    var startNode = tree.root;
    var levelItems = [];
    startNode && startNode.children.forEach(element => {
      correctTheTree(element);
      levelItems.push(element.value);
    });
    localStorage.setItem("ul-level-1", JSON.stringify(levelItems));
  }

  function correctTheTree(startNode){
    var array = [];
    startNode.children && startNode.children.forEach(element =>{	    
	    correctTheTree(element);
	    array.push(element.value);
    })
    startNode.value.value = array;
  }
	
  function saveFromMap(){
	var levelItems = [];
	mainMenuMap.forEach(item => {
		levelItems.push(item);
	});
	localStorage.setItem("ul-level-1", JSON.stringify(levelItems));
  }
  
  const InteractionType = Object.freeze({
	"Message":1,
	"Folder":2
  })  
	
  function addFolderOrMessage(interactionType){    
    globalSettings.lastAction = interactionType;
    $("#addMessageOrFolderDialog").dialog("open");
  }
  
  function onAddMsgFoldrDlgClose(){
	$("#interactionTypes").dialog( "close" );
  }
  
  /*
  (type: leaf,
  name: xyz,
  image: image base 64
  parent: root)
  (type: folder,
name: text,
value: ())
  */
  
  function Settings(adminMode, menuId) {
    this.adminMode = adminMode;
    this.menuId = menuId;
    this.greeting = function() {
      alert('Hi! I\'m ' + this.name + '.');
    };
  }  
  
  const handleSuccess = function(stream) {
    const saveButton = document.getElementById('save');
    
    const options = {mimeType: 'audio/webm'};
    const recordedChunks = [];
    const mediaRecorder = new MediaRecorder(stream, options);

    mediaRecorder.addEventListener('dataavailable', function(e) {
      if (e.data.size > 0) recordedChunks.push(e.data);
    });

    mediaRecorder.addEventListener('stop', async function() {
      globalSettings.voice = new Blob(recordedChunks);
      const base64Voice = await toBase64(globalSettings.voice);
      window.localStorage.setItem(globalSettings.menuId.toLowerCase(), base64Voice);
      /*toBase64(URL.createObjectURL(new Blob(recordedChunks))).then(base64VoiceFile => {
        localStorage.setItem(globalSettings.menuId.toLowerCase(), base64VoiceFile);
        console.log(localStorage.getItem(globalSettings.menuId.toLowerCase()));        	
      });*/
      //downloadLink.href = URL.createObjectURL(new Blob(recordedChunks));
      //downloadLink.download = 'acetest.wav';
    });

    saveButton.addEventListener('click', function() {
      mediaRecorder.stop();
    });

    mediaRecorder.start();
  };
  
  function startRecording(){
    navigator.mediaDevices.getUserMedia({ audio: true, video: false })
      .then(handleSuccess);
  }
  
  function getAudioFile(submenuId){
    var audioFile;
    switch(submenuId){
      case 'food-menu': audioFile = 'https://drive.google.com/file/d/1HnqTHf1tbl-iWUbnChaYdrCHyBTirOzD/view?usp=sharing';
    }
    return audioFile;
  }
  
  function getAudioFileAsBase64(submenuId){    
    var localStorage = window.localStorage;
    var audioBase64 = localStorage.getItem(submenuId);
    /*switch(submenuId){
      case 'pain-menu': audioBase64 = localStorage.getItem();break;
      case 'food-menu': audioBase64 = 
    }*/
    //return 'data:audio/wav;base64,' + audioBase64;
    return audioBase64;
  }
  
  function showSubMenu(submenuId){
    document.getElementById("main-menu").style.display="none";
    document.getElementById(submenuId).style.display="block";
    document.getElementById("back").style.display="block";
    //var audio = new Audio(getAudioFileAsBase64(submenuId.toLowerCase()));    
    //audio.play();
    handleMenuDisplay(submenuId);
  }
  
  function showMainMenu(menuId){
    document.getElementById("main-menu").style.display="table";
    document.getElementById("food-menu").style.display="none";
    document.getElementById("pain-menu").style.display="none";
    document.getElementById("back").style.display="none";
  }
  
  function showText(val){
    handleMenuDisplay(val.innerText);
    //alert(val.innerHTML);
  }
  
  async function playRecordedAudio(param){
    try{
      var menuId = param ? param : globalSettings.menuId.toLowerCase();
      var localStorage = window.localStorage;
      const base64Data = localStorage.getItem(menuId);
      const base64Response = await fetch(base64Data);
      var audio = new Audio(URL.createObjectURL(dataURItoBlob(base64Data)/*new Blob(localStorage.getItem('food'))*/));
      //alert(globalSettings.menuId);
      audio.play();
    }catch(e){
      console.log(e);
    }
  }
  
  function handleMenuDisplay(menuId){
    globalSettings.menuId = menuId;
    if (globalSettings.adminMode){
    	document.getElementById("record-controls").style.display="table";
    }else{
      	
    }    
    playRecordedAudio();
  }
  
  function showSettings(){
    if (!globalSettings.settingsClickCount){
      globalSettings.settingsClickCount = 1;
    }else{
      globalSettings.settingsClickCount = globalSettings.settingsClickCount + 1;
    }
    if (globalSettings.settingsClickCount >= 3){
    	globalSettings.adminMode = !globalSettings.adminMode;
	if (globalSettings.adminMode){
		document.getElementById("addInteractionDiv").style.display="table";
		document.getElementById("footer-level-1").style.display="table";
		document.getElementById("exportDiv").style.display="table";
		document.getElementById("importDiv").style.display="table";
	}else{
		document.getElementById("addInteractionDiv").style.display="none";
		document.getElementById("footer-level-1").style.display="none";
		document.getElementById("exportDiv").style.display="none";
		document.getElementById("importDiv").style.display="none";
	}
	if (globalSettings.settingsClickCount === 4){
	  globalSettings.settingsClickCount = 0;
	}
    }
  }
  
  toBase64 = file => new Promise((resolve, reject) => {
    const reader = new FileReader();
    reader.readAsDataURL(file);
    reader.onload = () => resolve(reader.result);
    reader.onerror = error => reject(error);
  });
  
  async function voiceFilesUploaded(event){
	var localStorage = window.localStorage;
    document.querySelector('#upload-files').files && Array.from(document.querySelector('#upload-files').files).forEach(voiceFile => {
      toBase64(voiceFile).then(base64VoiceFile => {
        localStorage.setItem(voiceFile.name.replaceAll('.m4a','').toLowerCase(), base64VoiceFile);
        console.log(localStorage.getItem(voiceFile.name.replaceAll('.m4a','').toLowerCase()));        	
      });      
    });
    
  }
  
  function closeVoiceControls(){
    document.getElementById("record-controls").style.display="none";
  }
  
  function dataURItoBlob(dataURI) {
    // convert base64 to raw binary data held in a string
    // doesn't handle URLEncoded DataURIs - see SO answer #6850276 for code that does this
    var byteString = atob(dataURI.split(',')[1]);

    // separate out the mime component
    var mimeString = dataURI.split(',')[0].split(':')[1].split(';')[0]

    // write the bytes of the string to an ArrayBuffer
    var ab = new ArrayBuffer(byteString.length);

    // create a view into the buffer
    var ia = new Uint8Array(ab);

    // set the bytes of the buffer to the correct values
    for (var i = 0; i < byteString.length; i++) {
        ia[i] = byteString.charCodeAt(i);
    }

    // write the ArrayBuffer to a blob, and you're done
    var blob = new Blob([ab], {type: mimeString});
    return blob;

  }
  
  function chooseInterationType(){
	$( "#interactionTypes" ).dialog();
  }
  
  function deleteWord(){
	if (document.getElementById("textareaEle").value){
	  var lastIndex = document.getElementById("textareaEle").value.lastIndexOf(' ');
	  document.getElementById("textareaEle").value = document.getElementById("textareaEle").value.substring(0, lastIndex);
	}
  }
  
  function readWords(){
	promptItem(document.getElementById("textareaEle").value);
  }  

  function displayPicture(){
    document.querySelector('#uploadItemPhoto').files && Array.from(document.querySelector('#uploadItemPhoto').files).forEach(pictureFile => {
      var image = document.querySelector('#itemPhoto');
      image.style.visibility = "visible";
      image.src = URL.createObjectURL(pictureFile);
    });
  }

  function updateSearchVal(e){
    document.getElementById("search-name").value = e.value;
  }

  /*
  ** Image Search functionality
  */
  const handle = "pZCY6KuRGrSRpPbXlovz3Nww5I0eF6x3Dc22X0Cfj2ow0oyljl7AzSAy";
  var fileIndex = 0;
  var searchResults = [];
  function fetchNRenderNextImage(){
    var image = document.getElementById('itemPhoto');
    fetch(searchResults[fileIndex].src.medium , {
      headers: {
          "Authorization": handle
      }
    })
    .then((response) => {
      return response.blob();
    })	      
    .then((blob) => {
      var reader = new FileReader();
      reader.readAsDataURL(blob); 
      reader.onloadend = function() {
        var base64data = reader.result;              
        console.log(base64data);
	image.src = base64data;	
      }	
    });  
  }

  function doImgSearch(event){
    fileIndex = 0;
    var apiUrl = "https://api.pexels.com/v1/search?query=" + document.getElementById("search-name").value + "&per_page=80"; 
    fetch(apiUrl, {
      headers: {
        "Authorization": handle
      }
    })
    .then(response => response.json())
    .then(searchRes => {
      searchResults = searchRes.photos;
      fetchNRenderNextImage();
    }); 
  }

  function fetchPrev(){
    if (fileIndex > 0){
      fileIndex = fileIndex - 1;
      fetchNRenderNextImage();
    }
  }

  function fetchNext(){
    if (fileIndex < 79){
      fileIndex = fileIndex + 1;
      fetchNRenderNextImage();
    }
  }
</script>

<div class="top-row prevent-select">
  <div id="addInteractionDiv" class="addInteractionDiv" style="display:none">
	<button id="addInteractionBtn" onclick="chooseInterationType()">Add</button>
  </div>
  <div id="backButtonDiv" class="backButtonDiv" style="display:none">
	<a id="backButton" href="#" onclick="onBackButtonClick()">Back</a>
  </div>
  <div id="record-controls" style="display:none">
    <button id="record" onclick="startRecording()">Record</button>
    <button id="stop">Stop</button>
    <button id="play" onclick="playRecordedAudio()">Play</button>
    <button id="save">Save</button>
    <button id="close-record-controls" onclick="closeVoiceControls()">Close</button>
  </div>
  <div  class="top-left-column top-left">
      <a id="back" style="display:none" href="#" onclick="showMainMenu('main-menu')">Back</a>
  </div>  
</div>  

<!--Notes: for now when you click on a tile, its text will be added to below implemented TextArea.
-->
<div id="level-1" class="prevent-select">
	<div id="topTextArea" class="topTextArea">
		<div id="keyboardIcon" class="keyboardIcon">
			<img style="width: 100%; height: auto" src="data:image/jpg;base64, /9j/4AAQSkZJRgABAQEAkACQAAD/4REwRXhpZgAATU0AKgAAAAgABAE7AAIAAAAiAAAISodpAAQAAAABAAAIbJydAAEAAABEAAAQ5OocAAcAAAgMAAAAPgAAAAAc6gAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFZlbmthdGEgTmFnYSBTdWRoYWthciBWYW5rYW1hbWlkaQAABZADAAIAAAAUAAAQupAEAAIAAAAUAAAQzpKRAAIAAAADMDAAAJKSAAIAAAADMDAAAOocAAcAAAgMAAAIrgAAAAAc6gAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADIwMjI6MTA6MjIgMTA6MjA6MzIAMjAyMjoxMDoyMiAxMDoyMDozMgAAAFYAZQBuAGsAYQB0AGEAIABOAGEAZwBhACAAUwB1AGQAaABhAGsAYQByACAAVgBhAG4AawBhAG0AYQBtAGkAZABpAAAA/+ELNGh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8APD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iPjxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iLz48cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0idXVpZDpmYWY1YmRkNS1iYTNkLTExZGEtYWQzMS1kMzNkNzUxODJmMWIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+PHhtcDpDcmVhdGVEYXRlPjIwMjItMTAtMjJUMTA6MjA6MzIuMDAzPC94bXA6Q3JlYXRlRGF0ZT48L3JkZjpEZXNjcmlwdGlvbj48cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0idXVpZDpmYWY1YmRkNS1iYTNkLTExZGEtYWQzMS1kMzNkNzUxODJmMWIiIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyI+PGRjOmNyZWF0b3I+PHJkZjpTZXEgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj48cmRmOmxpPlZlbmthdGEgTmFnYSBTdWRoYWthciBWYW5rYW1hbWlkaTwvcmRmOmxpPjwvcmRmOlNlcT4NCgkJCTwvZGM6Y3JlYXRvcj48L3JkZjpEZXNjcmlwdGlvbj48L3JkZjpSREY+PC94OnhtcG1ldGE+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDw/eHBhY2tldCBlbmQ9J3cnPz7/2wBDAAcFBQYFBAcGBQYIBwcIChELCgkJChUPEAwRGBUaGRgVGBcbHichGx0lHRcYIi4iJSgpKywrGiAvMy8qMicqKyr/2wBDAQcICAoJChQLCxQqHBgcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKir/wAARCAA+AGwDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwDq/C3hWx1zSnubuSdHWYxgRMACMA9weea2v+FeaT/z3vP++1/+Jpfh7/yL03/Xy3/oC1ymu61qkev30cWoXUaJO6qqTMoABwBgGvif3FKhCc4XufR+/KbSZ1X/AArzSf8Anvef99r/APE0f8K80n/nvef99r/8TVTwDqN7e3N4l5dTTqqKVErlsHJ6ZrlD4i1gsT/ad11/56miVTDRhGfs97/gCjUbavsdt/wrzSf+e95/32v/AMTR/wAK80n/AJ73n/fa/wDxNJot/d3HgXULia5keaOOXZIW+ZcRgjnr1NcN/bmrf9BS9/8AAh/8adSeGpqL9nuKKqSbVzuv+FeaT/z3vP8Avtf/AImj/hXmk/8APe8/77X/AOJqrNqV6nw1gu1upRcFtpm3ncR5hHX6CuUi8QauZkB1O6wWH/LU0VKmGg1enuk/vHGNR31O1/4V5pP/AD3vP++1/wDiaP8AhXmk/wDPe8/77X/4mq/jbU72zstMa0upIWlVi5jbbu4X0+prn9E13VZddso5dQuHR50VlaQkEFgCMH606ksNCp7NwFFVHHmudR/wrzSf+e95/wB9r/8AE0f8K80n/nvef99r/wDE1m+O9SvrPWYI7S8ngQ24YrFIVBO5uePpVPwhq2o3PiW3iub64mjYOGSSUsD8hPQ+4ocsMq3suTrYLVOXmub3/CvNJ/573n/fa/8AxNcHq9pHYaxdWsJYxwyFFLHJIHrXs9eP+JP+Rm1D/ru1Tj6NOnBOCtqOjOUm7s7b4e/8i9N/18t/6AtVNT8BS32qXN1HfIqzSF9rIcjPOKt/D3/kXpv+vlv/AEBa4vxMxPia/wAk/wCuPenUlCOFg5xv87BFN1HZ2O88MeGJNAmuJJblZjKoUBVxjFY5+HBycah9P3f/ANej4cE7r4ZOPl4z9a4csSxyT19azqVKKowbhpr1HGMud6nrGneH/sPh250trjf9oV1MgT7u5dvTNc//AMK2/wCor/5L/wD2VWPDkjp8P9QZWYMiSlSDyv7sHj8a4X7dd/8AP1P/AN/DV1qlBQhzQvp3FCM7uzPTZPDG/wAJpov2r7hz5uzGfmLdM+9Yi/DpkcMNQGQc/wCr/wDr0/UZpW+GcTtI5csAWLHJG8jr+FcTDLIZ0/eP94fxH1pYipRUopwvouoQjNp2Z6d4g8M/25b2kYufKNsCMlc7sgf4VmWHgI2WpW919u3CGRZNvl9cEHHX2qt4+lkFhpOHYblctg9Tha5rQJpR4hsMSP8A8fEY+8ehYA061Siq9nC701uEIy5Lpne+IvCQ1+9iufthtykflkeVvzyT6j1qHRfBQ0fVo70X5mEe7CeTtzkEddx9awviIx/t23GTj7MP/Qmql4JZv+EqteTyHB56/I1OVSl9a5XDW61v+glGXs73PU68f8Sf8jNqH/Xdq9grx/xJ/wAjNqH/AF3atMy/hx9RYf4mdt8Pf+Rem/6+W/8AQFqPVPDehXOqTz3WpJDNI250aZRtP0NSfD3/AJF6b/r5b/0Ba4rxL/yM1/8A9djUVJxhhYOUbjSbqOzseh+HNI07TPPbTLsXO/Afa4YL+VY0vhDw/DK0cuprG4PKvMoIqH4cfevvov8AWua8Sf8AIzah/wBd2qalWmsPCbguug4xlztXO/s4NGstEuNNi1WAxzq4LGdMjcu3jn0rB/4RHRsf8h61z9V/+Lri6K5pYqE0lKmtPNmiptbM9PktNHm8OJpEurW5RTnzBKoyd2emfeskeFdBVgRrUAIOQfNX/wCKrhqKJYqErc1NaAqbW0j07WrLRdagto5tVgT7MCFImU5BA68+wqppnhXSE1GGa01NJpIXWQJG4JO0g+p4rzyuj8Df8jLD9G/9BatYYiFaquaCuyXBxi7M67xHouk6heRT6pfLayCPYoaVV3AHPf61X0XQ9DstWinsNTjnnXdtjWZWzkEdAc9CayPiP/yELL/rk386yPCH/I0Wv1Na1KsFiuXkV7rUiMW6d7nrFeP+JP8AkZtQ/wCu7V7BXj/iT/kZtQ/67tWmZfw4+osP8TO2+Hv/ACL03/Xy3/oC1oXfhPSr27kuZom8yU7mw3U15xp/iHVNKtzBYXXlRs28r5atzgDuD6CrX/Caa/8A8/8A/wCQY/8A4msaeMoKlGE4t29P8ypUp8zaZ6Npeh2WjmQ2SMpkxuyc9Kq3fhLSry7kuZom8yVtzYbqa4P/AITTX/8An/8A/IMf/wATR/wmmv8A/P8A/wDkGP8A+Jq3jcM48ri7ei/zF7Kpe9zt/wDhCdG/55P/AN9D/Cj/AIQnRv8Ank//AH0P8K4j/hNNf/5//wDyDH/8TR/wmmv/APP/AP8AkGP/AOJqfrWE/k/Bf5j9nV7nb/8ACE6N/wA8X/76H+FH/CE6N/zyf/vof4VxH/Caa/8A8/8A/wCQY/8A4mj/AITTX/8An/8A/IMf/wATR9awn8n4L/MPZ1e52/8AwhOjf88n/wC+h/hVnT/DOm6Zdrc2sbCRQQCW9RivP/8AhNNf/wCf/wD8gx//ABNH/Caa/wD8/wD/AOQY/wD4mmsXhU7qH4L/ADF7Ko+p6Pqeh2GrvG99DvaMEKc44NQWfhfS7C7S5toCsiHKnca8/wD+E01//n//APIMf/xNH/Caa/8A8/8A/wCQY/8A4mqeNwzlzOOvov8AMPY1LWuer14/4k/5GbUP+u7VZ/4TTX/+f/8A8gx//E1j3NzLd3UlxcPvlkbc7YAyfwrmxmKhXilFMulTcHdn/9k=" />
		</div>
		<div id="textAreaDiv" style="width: 60%">
			<textarea id="textareaEle" class="textArea" onclick="readWords()"></textarea>
		</div>
		<div id="delete-word" class="keyboardIcon">
			<img name="delete-word-img" onclick="deleteWord()" style="width: 70%; height: 75%" src="data:image/jpg;base64, /9j/4AAQSkZJRgABAQEAkACQAAD/4REwRXhpZgAATU0AKgAAAAgABAE7AAIAAAAiAAAISodpAAQAAAABAAAIbJydAAEAAABEAAAQ5OocAAcAAAgMAAAAPgAAAAAc6gAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFZlbmthdGEgTmFnYSBTdWRoYWthciBWYW5rYW1hbWlkaQAABZADAAIAAAAUAAAQupAEAAIAAAAUAAAQzpKRAAIAAAADMjAAAJKSAAIAAAADMjAAAOocAAcAAAgMAAAIrgAAAAAc6gAAAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADIwMjI6MTA6MzEgMDA6MjU6MDkAMjAyMjoxMDozMSAwMDoyNTowOQAAAFYAZQBuAGsAYQB0AGEAIABOAGEAZwBhACAAUwB1AGQAaABhAGsAYQByACAAVgBhAG4AawBhAG0AYQBtAGkAZABpAAAA/+ELNGh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8APD94cGFja2V0IGJlZ2luPSfvu78nIGlkPSdXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQnPz4NCjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iPjxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+PHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9InV1aWQ6ZmFmNWJkZDUtYmEzZC0xMWRhLWFkMzEtZDMzZDc1MTgyZjFiIiB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iLz48cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0idXVpZDpmYWY1YmRkNS1iYTNkLTExZGEtYWQzMS1kMzNkNzUxODJmMWIiIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+PHhtcDpDcmVhdGVEYXRlPjIwMjItMTAtMzFUMDA6MjU6MDkuMjAxPC94bXA6Q3JlYXRlRGF0ZT48L3JkZjpEZXNjcmlwdGlvbj48cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0idXVpZDpmYWY1YmRkNS1iYTNkLTExZGEtYWQzMS1kMzNkNzUxODJmMWIiIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyI+PGRjOmNyZWF0b3I+PHJkZjpTZXEgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj48cmRmOmxpPlZlbmthdGEgTmFnYSBTdWRoYWthciBWYW5rYW1hbWlkaTwvcmRmOmxpPjwvcmRmOlNlcT4NCgkJCTwvZGM6Y3JlYXRvcj48L3JkZjpEZXNjcmlwdGlvbj48L3JkZjpSREY+PC94OnhtcG1ldGE+DQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIDw/eHBhY2tldCBlbmQ9J3cnPz7/2wBDAAcFBQYFBAcGBQYIBwcIChELCgkJChUPEAwRGBUaGRgVGBcbHichGx0lHRcYIi4iJSgpKywrGiAvMy8qMicqKyr/2wBDAQcICAoJChQLCxQqHBgcKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKir/wAARCABTAGQDASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwBlFFFfmJ9aFFFFABRRRQAUUUUAFFFFABRRRQAUUUUAFFFFABRRT4YZbiZYoI2kkc4VFGSae4hlFdrpvgUxWcl3rDYZY2ZYEPQ4/iP9B+fauh0rQ9On0eylmtVeSS3RmYk5JKgk9a7qeBqz30MZVoo8por2H/hHtK/580/M/wCNH/CPaV/z5p+Z/wAa2/s2p/MifrEex49RXp/iLRdOt/Dt7LDaqkiRkqwJ4/WvMK48Rh5UJKLZrCamroKKKK5jQKKKKACiiigDc0Hwre63iUYgtc4MzDr/ALo7/wAq9G0jQrHRYdtnF85GHlblm/H+gryvS9ZvtHn8yxmKgn5ozyr/AFH+TXomheMLHV9sM5FrdHjYx+Vz/sn+nX617GBnh1p9rz/Q5ayn8javv+Qfcf8AXJv5GodF/wCQBp//AF7R/wDoIqa9/wCQfcf9cm/lUOi/8gDT/wDr2j/9BFer/wAvPkc32Tg/ijrd94EvNO8Y2d7LLaoTZ3ekyXJWO4DAlXRTkB1I5IGSPYHO58NLe/8A+ELttT1jVJdSvtW/06R2nLxxB+VjjB4VVBAwO+fap9R8HDWfG9nrer3i3Vlp8DJaaYYPkSVuGlZiTuOOAMDHH4v8GeFH8HWN3psOoG601rl5rKBotrWiMSTHu3HcMnI4GMnr26lKPs7df+Dt+v4GLT501t/wN/0/Eu+KP+RXv/8Arkf515FXrvij/kV7/wD65H+deRV85mX8Reh6GH+FhRRRXlnSFFFFABRRRQAUUUUAdFpXjG9srZ7S8zdW7IUBY/OmRjg9x7H9K3tP8d6XaaZa28kN0XhhSNiqLgkKBx81ef0V108XWhszKVKLPSf+Fh6R/wA8bz/v2v8A8VR/wsPSP+eN5/37X/4qvNqK1/tCv5E+wgd3rXjbTdR0W6tIIroSTJtUuigZ/wC+q4SiiuatWnWd5mkYKCsgooorAsKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooAKKKKACiiigAooooA//2Q==" />
		</div>
		<div id="exportDiv" class="" style="display:none; padding-right: 1%">
		  <a href="#" onclick="exportConfig()">Export</a>
	  	</div>
		<div id="importDiv" class="" style="display:none">
		  <a href="#" onclick="importDialog()">Import</a>
	  	</div>
	</div>
	<ul id="ul-bread-crumbs" class="breadcrumb-navigation">		
	</ul>
	<ul id="ul-level-1" class="ul-container">
	</ul>
</div>
<div id="aac-settings-icon" class="admin-settings">
  <a href="#" onclick="showSettings()">Settings</a>
</div>

<!-- Footer -->
<div id="footer-level-1" style="display:none">
  </br>	
  <a href="https://youtu.be/fJvelltfSwo" target="_blank">Demo video</a>	
</div>

<ul id="item-edit-menu" style="display:none; width: 150px;">
  <li onclick="deleteItem()"><div>Delete</div></li>
  <li onclick="editItemContents()"><div>Edit contents</div></li>
</ul>

<div id='addMessageOrFolderDialog' style="display:none">
	<!--same div for both folder or message, in either case, should be able to 
		enter name, record voice, set/upload picture-->
	<form>
		<fieldset>
			<label for="name">Name</label>
			<input type="text" name="name" id="name" class="text ui-widget-content ui-corner-all" style="margin-bottom: 20px" onfocusout="updateSearchVal(this)">
			<div style="display: block">
			  <label for="search-name">Search</label>
			  <input type="text" name="search-name" id="search-name" class="text ui-widget-content ui-corner-all" style="margin-bottom: 20px" onfocusout="doImgSearch()">
			</div>
			<div style="display: flex">
			  <label for="itemPhoto">Picture</label>
			  <input type="file" id="uploadItemPhoto" style="margin-left: 10px" onchange="displayPicture()"/>
			</div>
			<img name="itemPhoto" id="itemPhoto" style="width: 50%; height: 50%; margin-top: 20px; border:0px"/>			
			<input type="button" id="left-nav-img-search" value="Prev" onclick="fetchPrev()"/>
			<input type="button" id="right-nav-img-search" value="Next" onclick="fetchNext()"/>
			<!-- Allow form submission with keyboard without duplicating the dialog button -->
			<input type="submit" tabindex="-1" style="position:absolute; top:-1000px">
		</fieldset>
	</form>
</div>

<div id='importConfigDialog' style="display:none">	
	<form>
		<fieldset>			
			<div style="display: flex">
			  <label for="importConfigFile">Import config</label>
			  <input type="file" id="importConfigFile" style="margin-left: 10px" />
			</div>			
			<!-- Allow form submission with keyboard without duplicating the dialog button -->
			<input type="submit" tabindex="-1" style="position:absolute; top:-1000px">
		</fieldset>
	</form>
</div>

<div id='interactionTypes' title="Add" class="interactionTypes" style="display:none">
  <a href="#" onclick="addFolderOrMessage(InteractionType.Message)">Add message</a><p/>
  <a href="#" onclick="addFolderOrMessage(InteractionType.Folder)">Add folder</a>
</div>

<div id='aac_settings' style="display:none">
  <label for="upload-files">Select voice files to load:</label>
  <input type="file" multiple=true id="upload-files" onchange='voiceFilesUploaded(event)'/>
</div>
